#' Fit and Evaluate model
#'
#' @param train_set
#' @param test_set
#' @param inducer
#' @param verbose
#' 
#' @return criteria list
#' 
fit_and_evaluate_model = function(train_set,
                                  test_set,
                                  inducer=c("RF","GLM","J48","SVM"),
                                  seed=1984,
                                  verbose=TRUE){
    return_list = list()
    
    
    ###############################
    # Standardize variables names #
    ###############################
    colnames(train_set) = c(paste0("X",1:(ncol(train_set)-1)),"label")  
    colnames(test_set)  = c(paste0("X",1:(ncol(test_set)-1)),"label")  
    
    
    #################################
    # Fit model to the training-set #
    #################################
    set.seed(seed)
    model = e1071::svm(label ~ ., data=train_set,
                       scale=T, cost=1e0, probability=TRUE)
    y_hat = predict(model, test_set, probability=TRUE)
    y_hat = attr(y_hat, "probabilities")
    predictions = as.vector(y_hat[,"minority"])
    
    
    #######################################
    # Extract elements of the SVM object  #
    #######################################
    # Support Vectors information
    SV_index = rownames(model$SV)
    return_list[["SV_total"]]    = length(SV_index)
    return_list[["SV_minority"]] = table(train_set[SV_index,"label"])[["minority"]]
    return_list[["SV_majority"]] = table(train_set[SV_index,"label"])[["majority"]]
    
    
    ##################################
    # Evaluate model on the test-set #
    ##################################
    pred  = ROCR::prediction(predictions, test_set[,"label"])
    ## Precision and Recall
    PR_obj        = ROCR::performance(pred, "prec", "rec")
    Recall_vec    = unlist(PR_obj@x.values)
    Precision_vec = unlist(PR_obj@y.values)
    ## PRBEP (Precision Recall Break-Even Point)
    PREBP_index            = which.min(abs(Recall_vec-Precision_vec))[1]
    return_list[["PRBEP"]] = Recall_vec[PREBP_index] #= Precision_vec[PREBP_index]
    ## AUC
    AUC_obj = ROCR::performance(pred,"auc")
    return_list[["AUC"]] = AUC_obj@y.values[[1]]
    ## Lift value as a function of "rate of poisitve predictions"
    LIFT_obj = ROCR::performance(pred, measure="lift", x.measure="rpp")
    return_list[["LIFT"]] = unlist(LIFT_obj@y.values)[1086] # unlist(LIFT_obj@x.values)[[1086]]=0.1
    
    
    return(return_list)
} # end fit_and_evaluate_model
